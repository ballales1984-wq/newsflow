<mat-card class="article-card" (click)="viewArticle()">
  <div class="card-image" *ngIf="article.image_url">
    <img [src]="article.image_url" [alt]="article.title" />
    <div class="quality-badge" *ngIf="article.quality_score">
      <mat-chip [color]="getQualityColor(article.quality_score)">
        {{ (article.quality_score * 100).toFixed(0) }}%
      </mat-chip>
    </div>
  </div>

  <mat-card-header>
    <mat-card-title>{{ article.title }}</mat-card-title>
    <mat-card-subtitle>
      <span *ngIf="article.author">{{ article.author }} · </span>
      <span>{{ formatDate(article.published_at) }}</span>
      <span *ngIf="article.reading_time_minutes"> · {{ article.reading_time_minutes }} min</span>
    </mat-card-subtitle>
  </mat-card-header>

  <mat-card-content>
    <!-- Mostra content completo se disponibile, altrimenti summary -->
    <p class="summary" *ngIf="article.content && article.content.length > 0">
      {{ article.content.length > 400 ? (article.content.substring(0, 400) + '...') : article.content }}
    </p>
    <p class="summary" *ngIf="!article.content || article.content.length === 0">
      {{ article.summary }}
    </p>

    <div class="keywords" *ngIf="article.keywords && article.keywords.length > 0">
      <mat-chip-set>
        <mat-chip *ngFor="let keyword of article.keywords.slice(0, 5)">
          {{ keyword }}
        </mat-chip>
      </mat-chip-set>
    </div>
  </mat-card-content>

  <mat-card-actions>
    <div class="actions-left">
      <button 
        mat-icon-button 
        matTooltip="Salva" 
        (click)="saveArticle($event)"
        [color]="isSaved() ? 'primary' : ''"
        [attr.aria-label]="isSaved() ? 'Rimuovi dai salvati' : 'Salva articolo'"
      >
        <mat-icon>{{ isSaved() ? 'bookmark' : 'bookmark_border' }}</mat-icon>
      </button>
      <button 
        mat-icon-button 
        matTooltip="Condividi" 
        (click)="shareArticle($event)"
        aria-label="Condividi articolo"
      >
        <mat-icon>share</mat-icon>
      </button>
      <a 
        [href]="article.url" 
        target="_blank" 
        mat-icon-button 
        matTooltip="Apri originale"
        (click)="$event.stopPropagation()"
        aria-label="Apri articolo originale in nuova scheda"
      >
        <mat-icon>open_in_new</mat-icon>
      </a>
    </div>
    <div class="actions-right">
      <button 
        mat-stroked-button 
        color="accent" 
        (click)="explainArticle($event)"
        matTooltip="Spiegazione AI con 3 livelli di profondità"
      >
        <mat-icon>school</mat-icon>
        Spiegami
      </button>
      <button mat-button color="primary" (click)="viewArticle()">
        Leggi
        <mat-icon>arrow_forward</mat-icon>
      </button>
    </div>
  </mat-card-actions>
</mat-card>

